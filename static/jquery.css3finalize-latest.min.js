/**
 * @author Han Lin Yap < http://zencodez.net/ >
 * @copyright 2010 zencodez.net
 * @license http://creativecommons.org/licenses/by-sa/3.0/
 * @package Css3-Finalize
 * @version 1.6 - 2010-10-29
 * @website http://github.com/codler/jQuery-Css3-Finalize
 *
 * == Description == 
 * Some css3 attributes needs to have a prefix infront
 * inorder to work in diffrent browser. The plugin takes
 * care of that so you only need to write without the prefix.
 *
 * == Example Usage ==
 * // This will look for all style-tags and parse them.
 * $.cssFinalize('style');
 */
(function(a){a.cssFinalize=function(e){var b=false;if(a.browser.webkit||a.browser.safari){b="webkit"}else{if(a.browser.mozilla){b="moz"}else{if(a.browser.msie){b="ms"}else{if(a.browser.opera){b="o"}}}}function h(o){return function(p){return o}}var n={"background-clip":["webkit","khtml"],"background-origin":["webkit","khtml"],"background-size":["moz","webkit","khtml"],"border-image":["moz","webkit"],"border-top-image":["moz","webkit"],"border-right-image":["moz","webkit"],"border-bottom-image":["moz","webkit"],"border-left-image":["moz","webkit"],"border-corner-image":["moz","webkit"],"border-top-left-image":["moz","webkit"],"border-top-right-image":["moz","webkit"],"border-bottom-left-image":["moz","webkit"],"border-bottom-right-image":["moz","webkit"],"border-radius":["moz","webkit"],"border-top-left-radius":[h("-moz-border-radius-topleft"),"webkit"],"border-top-right-radius":[h("-moz-border-radius-topright"),"webkit"],"border-bottom-right-radius":[h("-moz-border-radius-bottomright"),"webkit"],"border-bottom-left-radius":[h("-moz-border-radius-bottomleft"),"webkit"],"box-align":["moz","webkit"],"box-direction":["moz","webkit"],"box-flex":["moz","webkit"],"box-flex-group":["moz","webkit"],"box-lines":["moz","webkit"],"box-ordinal-group":["moz","webkit"],"box-orient":["moz","webkit"],"box-pack":["moz","webkit"],"box-shadow":["moz","webkit"],"box-sizing":["moz","webkit"],"column-count":["moz","webkit"],"column-gap":["moz","webkit"],"column-rule":["moz","webkit"],"column-rule-color":["moz","webkit"],"column-rule-style":["moz","webkit"],"column-rule-width":["moz","webkit"],"column-width":["moz","webkit"],"tab-size":["moz","o"],"text-overflow":["o"],"text-size-adjust":["webkit","ms"],transform:["moz","webkit","o","ms"],"transform-origin":["moz","webkit","o","ms"],transition:["moz","webkit","o"],"transition-delay":["moz","webkit","o"],"transition-duration":["moz","webkit","o"],"transition-property":["moz","webkit","o"],"transition-timing-function":["moz","webkit","o"]};function i(o){var p="";a.each(o,function(q,r){p+=r.selector+"{";a.each(r.attributes,function(t,s){p+=t+":"+s+";"});p+="}"});return p}function m(q){var p=q.split("{");if(p[0]!=""){var o=[{selector:a.trim(p.shift())}]}else{var o=[];p.shift()}a.map(p,function(y,u){var s=y.split("}");if(s[0]==""){if(s[1]){o[u+1]={selector:a.trim(s[1])}}return true}var w=s[0].split(":");var r={};var x,v=false;while(w.length>0){if(!v){x=a.trim(w.shift());r[x]=""}else{r[x]+=":";v=false}r[x]+=(function(){var t=w.shift().split(";");if(a.trim(t[1])){w.unshift(a.trim(t[1]))}else{v=true}return a.trim(t[0])})()}o[u].attributes=r;if(s[1]){o[u+1]={selector:a.trim(s[1])}}});return o}function f(o){o=o.replace(/\/\*((?:[^\*]|\*[^\/])*)\*\//g,"");o=o.replace(/\n/g,"");o=o.replace(/\r/g,"");return o}function l(o){var p={};a.each(o,function(s,r){var q=k(s);if(q){p[q]=r}var t=j(s,r);if(t){p[s]=t}});return p}function k(o){if(o in n){for(prefix in n[o]){if(a.isFunction(n[o][prefix])){return n[o][prefix](o)}else{if(b==n[o][prefix]||!b){return"-"+n[o][prefix]+"-"+o}}}}return false}function j(p,o){if(b=="moz"){if(o.indexOf("calc")==0){return"-moz-"+o}if(parseInt(a.browser.version.substr(0,1))<4){if(p=="background-clip"||p=="background-origin"){if(o=="padding-box"){return"padding"}else{if(o=="border-box"){return"border"}else{if(o=="content-box"){return"content"}}}}}}return false}function g(o){if(b=="moz"){o=o.replace("::selection","::-moz-selection")}return o}function c(p,q){q=f(q);var r=m(q);var o=[];a.each(r,function(s,u){if(u.attributes){var t=l(u.attributes);if(!a.isEmptyObject(t)){o.push({selector:g(u.selector),attributes:t})}}});p.addClass("css-finalize-read");if(o.length>0){d(p,o)}}if(!(e instanceof jQuery)){e=a(e)}e.each(function(o,p){var q=a(this);if(q.hasClass("css-finalize-read")){return true}if(this.tagName=="LINK"){a("<div />").load(this.href,function(r){c(q,r)})}else{c(q,q.html())}});function d(o,p){o.after('<style class="css-finalized">'+i(p)+"</style>")}};a.cssFinalize("style, link")})(jQuery);