/**
 * @author Han Lin Yap < http://zencodez.net/ >
 * @copyright 2010 zencodez.net
 * @license http://creativecommons.org/licenses/by-sa/3.0/
 * @package Css3-Finalize
 * @version 1.7 - 2010-10-29
 * @website http://github.com/codler/jQuery-Css3-Finalize
 *
 * == Description == 
 * Some css3 attributes needs to have a prefix infront
 * inorder to work in diffrent browser. The plugin takes
 * care of that so you only need to write without the prefix.
 *
 * == Example Usage ==
 * // This will look for all style-tags and parse them.
 * $.cssFinalize('style');
 */
(function(a){a.cssFinalize=function(e){var b=false;if(a.browser.webkit||a.browser.safari){b="webkit"}else{if(a.browser.mozilla){b="moz"}else{if(a.browser.msie){b="ms"}else{if(a.browser.opera){b="o"}}}}function h(p){return function(q){return p}}var o={animation:["webkit"],"animation-delay":["webkit"],"animation-direction":["webkit"],"animation-duration":["webkit"],"animation-iteration-count":["webkit"],"animation-name":["webkit"],"animation-timing-function":["webkit"],"backface-visibility":["webkit"],"background-clip":["webkit","khtml"],"background-origin":["webkit","khtml"],"background-size":["moz","webkit","khtml"],"border-image":["moz","webkit"],"border-top-image":["moz","webkit"],"border-right-image":["moz","webkit"],"border-bottom-image":["moz","webkit"],"border-left-image":["moz","webkit"],"border-corner-image":["moz","webkit"],"border-top-left-image":["moz","webkit"],"border-top-right-image":["moz","webkit"],"border-bottom-left-image":["moz","webkit"],"border-bottom-right-image":["moz","webkit"],"border-radius":["moz","webkit"],"border-top-left-radius":[h("-moz-border-radius-topleft"),"webkit"],"border-top-right-radius":[h("-moz-border-radius-topright"),"webkit"],"border-bottom-right-radius":[h("-moz-border-radius-bottomright"),"webkit"],"border-bottom-left-radius":[h("-moz-border-radius-bottomleft"),"webkit"],"box-align":["moz","webkit"],"box-direction":["moz","webkit"],"box-flex":["moz","webkit"],"box-flex-group":["moz","webkit"],"box-lines":["moz","webkit"],"box-ordinal-group":["moz","webkit"],"box-orient":["moz","webkit"],"box-pack":["moz","webkit"],"box-shadow":["moz","webkit"],"box-sizing":["moz","webkit"],"column-count":["moz","webkit"],"column-gap":["moz","webkit"],"column-rule":["moz","webkit"],"column-rule-color":["moz","webkit"],"column-rule-style":["moz","webkit"],"column-rule-width":["moz","webkit"],"column-width":["moz","webkit"],columns:["webkit"],marquee:["webkit"],"marquee-direction":["webkit"],"marquee-speed":["webkit"],"marquee-style":["webkit"],perspective:["webkit"],"perspective-origin":["webkit"],"tab-size":["moz","o"],"text-overflow":["o"],"text-size-adjust":["webkit","ms"],transform:["moz","webkit","o","ms"],"transform-origin":["moz","webkit","o","ms"],"transform-style":["webkit"],transition:["moz","webkit","o"],"transition-delay":["moz","webkit","o"],"transition-duration":["moz","webkit","o"],"transition-property":["moz","webkit","o"],"transition-timing-function":["moz","webkit","o"],"user-modify":["moz","webkit","khtml"],"user-select":["moz","webkit","khtml"]};function i(p){var q="";a.each(p,function(r,s){q+=s.selector+"{";a.each(s.attributes,function(u,t){q+=u+":"+t+";"});q+="}"});return q}function m(r){var q=r.split(/(:[^;]*;?)/);q.pop();var p={};a.map(q,function(t,s){if(s%2==1){p[a.trim(q[s-1])]=a.trim(t.substr(1).replace(";",""))}});return p}function n(r){var q=r.split(/({[^{}]*})/);q.pop();var p=[];a.map(q,function(t,s){if(s%2==0){p.push({selector:a.trim(t)})}else{p[p.length-1].attributes=m(t.substr(1,t.length-2))}});return p}function f(p){p=p.replace(/\/\*((?:[^\*]|\*[^\/])*)\*\//g,"");p=p.replace(/\n/g,"");p=p.replace(/\r/g,"");return p}function l(p){var q={};a.each(p,function(t,s){var r=k(t);if(r){q[r]=s}var u=j(t,s);if(u){q[t]=u}});return q}function k(p){if(p in o){for(prefix in o[p]){if(a.isFunction(o[p][prefix])){return o[p][prefix](p)}else{if(b==o[p][prefix]||!b){return"-"+o[p][prefix]+"-"+p}}}}return false}function j(q,p){if(b=="moz"){if(p.indexOf("calc")==0){return"-moz-"+p}if(parseInt(a.browser.version.substr(0,1))<4){if(q=="background-clip"||q=="background-origin"){if(p=="padding-box"){return"padding"}else{if(p=="border-box"){return"border"}else{if(p=="content-box"){return"content"}}}}}}return false}function g(p){if(b=="moz"){p=p.replace("::selection","::-moz-selection")}return p}function c(q,r){r=f(r);var s=n(r);var p=[];a.each(s,function(t,v){if(v.attributes){var u=l(v.attributes);if(!a.isEmptyObject(u)){p.push({selector:g(v.selector),attributes:u})}}});q.addClass("css-finalize-read");if(p.length>0){d(q,p)}}if(!(e instanceof jQuery)){e=a(e)}e.each(function(p,q){var r=a(this);if(r.hasClass("css-finalize-read")||r.hasClass("css-finalized")){return true}if(this.tagName=="LINK"&&r.attr("rel")=="stylesheet"){a("<div />").load(this.href,function(s){c(r,s)})}else{c(r,r.html())}});function d(p,q){p.after('<style class="css-finalized">'+i(q)+"</style>")}};a.cssFinalize("style, link")})(jQuery);