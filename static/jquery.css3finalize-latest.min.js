/**
 * @author Han Lin Yap < http://zencodez.net/ >
 * @copyright 2010 zencodez.net
 * @license http://creativecommons.org/licenses/by-sa/3.0/
 * @package Css3-Finalize
 * @version 1.3 - 2010-10-28
 * @website http://github.com/codler/jQuery-Css3-Finalize
 *
 * == Description == 
 * Some css3 attributes needs to have a prefix infront
 * inorder to work in diffrent browser. The plugin takes
 * care of that so you only need to write without the prefix.
 *
 * == Example Usage ==
 * // This will look for all style-tags and parse them.
 * $.cssFinalize('style');
 */
(function(a){a.cssFinalize=function(e){var b=false;if(a.browser.safari||a.browser.webkit){b="webkit"}else{if(a.browser.mozilla){b="moz"}else{if(a.browser.msie){b="ms"}else{if(a.browser.opera){b="o"}}}}function g(k){return function(l){return k}}var j={"background-clip":["webkit","khtml"],"background-origin":["webkit","khtml"],"background-size":["moz","webkit","khtml"],"border-image":["moz","webkit"],"border-top-image":["moz","webkit"],"border-right-image":["moz","webkit"],"border-bottom-image":["moz","webkit"],"border-left-image":["moz","webkit"],"border-corner-image":["moz","webkit"],"border-top-left-image":["moz","webkit"],"border-top-right-image":["moz","webkit"],"border-bottom-left-image":["moz","webkit"],"border-bottom-right-image":["moz","webkit"],"border-radius":["moz","webkit"],"border-top-left-radius":[g("-moz-border-radius-topleft"),"webkit"],"border-top-right-radius":[g("-moz-border-radius-topright"),"webkit"],"border-bottom-right-radius":[g("-moz-border-radius-bottomright"),"webkit"],"border-bottom-left-radius":[g("-moz-border-radius-bottomleft"),"webkit"],"box-align":["moz","webkit"],"box-direction":["moz","webkit"],"box-flex":["moz","webkit"],"box-flex-group":["moz","webkit"],"box-lines":["moz","webkit"],"box-ordinal-group":["moz","webkit"],"box-orient":["moz","webkit"],"box-pack":["moz","webkit"],"box-shadow":["moz","webkit"],"box-sizing":["moz","webkit"],"column-count":["moz","webkit"],"column-gap":["moz","webkit"],"column-rule":["moz","webkit"],"column-rule-color":["moz","webkit"],"column-rule-style":["moz","webkit"],"column-rule-width":["moz","webkit"],"column-width":["moz","webkit"],"tab-size":["moz","o"],"text-overflow":["o"],transform:["moz","webkit","o"],"transform-origin":["moz","webkit","o"],transition:["moz","webkit","o"],"transition-delay":["moz","webkit","o"],"transition-duration":["moz","webkit","o"],"transition-property":["moz","webkit","o"],"transition-timing-function":["moz","webkit","o"]};function h(k){var l="";a.each(k,function(n,m){l+=m.selector+"{";a.each(m.block,function(o,p){l+=o+":"+p+";"});l+="}"});return l}function i(m){var l=m.split("{");if(l[0]!=""){var k=[{selector:a.trim(l.shift())}]}else{var k=[];l.shift()}a.map(l,function(v,q){var p=v.split("}");if(p[0]==""){if(p[1]){k[q+1]={selector:a.trim(p[1])}}return true}var s=p[0].split(":");var o={};var u,r=false;while(s.length>0){if(!r){u=a.trim(s.shift());o[u]=""}else{o[u]+=":";r=false}o[u]+=(function(){var n=s.shift().split(";");if(a.trim(n[1])){s.unshift(a.trim(n[1]))}else{r=true}return a.trim(n[0])})()}k[q].block=o;if(p[1]){k[q+1]={selector:a.trim(p[1])}}});return k}function f(k){k=k.replace(/\/\*((?:[^\*]|\*[^\/])*)\*\//g,"");k=k.replace(/\n/g,"");k=k.replace(/\r/g,"");return k}function c(l,m){m=f(m);var n=i(m);var k=[];a.each(n,function(q,o){var p={};a.each(o.block,function(r,s){if(r in j){for(prefix in j[r]){if(a.isFunction(j[r][prefix])){p[j[r][prefix](r)]=s}else{if(b==j[r][prefix]||!b){p["-"+j[r][prefix]+"-"+r]=s}}}}if(b=="moz"){if(s.indexOf("calc")==0){p[r]="-moz-"+s}if(parseInt(a.browser.version.substr(0,1))<4){if(s=="padding-box"&&r=="background-clip"){p[r]="padding"}else{if(s=="border-box"&&r=="background-clip"){p[r]="border"}else{if(s=="content-box"&&r=="background-clip"){p[r]="content"}else{if(s=="padding-box"&&r=="background-origin"){p[r]="padding"}else{if(s=="border-box"&&r=="background-origin"){p[r]="border"}else{if(s=="content-box"&&r=="background-origin"){p[r]="content"}}}}}}}}});if(!a.isEmptyObject(p)){k.push({selector:o.selector,block:p})}});if(k.length>0){d(l,k)}}if(!(e instanceof jQuery)){e=a(e)}e.each(function(k,l){var m=a(this);if(m.hasClass("css-finalize-read")){return true}if(this.tagName=="LINK"&&a.browser.mozilla){a("<div />").load(this.href,function(n){c(m,n)})}else{c(m,m.html())}});function d(k,l){k.after('<style class="css-finalized">'+h(l)+"</style>").addClass("css-finalize-read")}};a.cssFinalize("style, link")})(jQuery);